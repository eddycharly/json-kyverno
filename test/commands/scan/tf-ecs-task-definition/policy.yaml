apiVersion: json.kyverno.io/v1alpha1
kind: ValidatingPolicy
metadata:
  name: required-s3-tags
spec:
  rules:
    - name: require-team-tag
      match:
        any:
        - type: aws_ecs_task_definition
      assert:
        any:
        - message: Bucket `{{ name }}` ({{ address }}) does not have the required tags {{ to_string($tags) }}
          check:
            values:
                ~.(json_parse(container_definitions)):
                    readonlyRootFilesystem: true

